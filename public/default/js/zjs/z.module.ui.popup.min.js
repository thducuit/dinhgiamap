zjs.require("ui",function(){zjs.extendCore({moduleUiPopupOption:{width:"auto",height:"auto",autoshow:!1,closebutton:!0,closethenremove:!1,pagecover:!0,clickout:!1,pressEsc:!0,center:!0,centerY:!1,fade:!0,fadeCover:!1,fadeTime:500,animate:!1,animateTime:1E3,animateName:"fadeInDown fadeOutUp"}});var m=function(){var a=!1;try{top.document.body.offsetTop=top.document.body.offsetTop,a=!0}catch(b){}a?isNaN(top.popuplastindex)&&(top.popuplastindex=1E4):isNaN(window.popuplastindex)&&(window.popuplastindex=
1E4);return function(){return a?top.popuplastindex++:window.popuplastindex++}}();window.zpopupelementstack=[];var q=function(a,b){var d=zjs(a),c=d.getData("zmoduleuipopupoption");if(c)d.setData("zmoduleuipopupoption",zjs.extend(c,b));else{var c=zjs.clone(zjs.moduleUiPopupOption),e=d.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(c=zjs.extend(c,e.jsonDecode()));d.removeAttr("data-option");"undefined"!=typeof b&&(c=zjs.extend(c,b));c.fadeTime=parseInt(c.fadeTime);c.animate&&(c.fade=!(c.fadeCover=
!0));c.animateTime=parseInt(c.animateTime);c.animateCoverTime=parseInt(c.animateCoverTime);d.setData("zmoduleuipopupoption",c);e=zjs.enablehook();zjs.enablehook(!1);d.addClass("zui-popup");c.center&&d.addClass("zui-popup-center");c.animate&&d.addClass(c.animateName).setStyle("animation-duration",c.animateTime+"ms");var f=zjs();if(c.pagecover){var f=zjs("<div>").addClass("zui-popup-page-cover"),g=d.getAttr("id","");""!=g&&f.addClass("zui-popup-page-cover-"+g);c.clickout&&f.click(function(){k(a)})}d.setData("zmoduleuipopupcoverel",
f);var h=zjs("<div>").addClass("zui-popup-wrapper");d.child().each(function(a){h.append(a)});d.append(h);zjs.enablehook(e);e=d.find(".zpopupclose");0==e.count()&&c.closebutton&&(e=zjs('<a class="zui-popup-close">\u00d7</a>').prependTo(d));e.click(function(b,c){this.hasClass("disabled")||k(a)});c.autoshow?n(a):k(a,!0,!0);d.removeClass("zui-uiuninithide zui-uiuninithideh");zjs(window).on("resize",function(){l(a)}).on("scroll",function(){l(a)})}},g=!1,h=!1,n=function(a){var b=zjs(a),d=b.data("zmoduleuipopupoption");
d&&(b.data("zmoduleuipopupcoverel").insertBefore(b).style("z-index",m()),b.removeClass("zui-popup-hide").style("z-index",m()),b.setData("zmoduleuipopupscrolltop",document.body.scrollTop),p(a),d.fade&&b.fadeIn({time:d.fadeTime}),d.fadeCover&&b.data("zmoduleuipopupcoverel").fadeIn({time:d.fadeTime}),d.animate&&(window.clearTimeout(g),window.clearTimeout(h),b.addClass("showing animate animate-start"),g=function(){b.addClass("animate-end")}.delay(d.animateTime),h=function(){b.removeClass("showing animate animate-start animate-end")}.delay(d.animateTime+
100)),b.addClass("active").trigger("ui.popup.show"),b.hasClass("zui-popup-center")&&l(a),d.pressEsc&&(a=zjs.getUniqueId(),b.setAttr("data-show-instance",a),window.zpopupelementstack.push(a)),function(){b.find(".autofocus").focus()}.delay(500))},k=function(a,b,d){var c=zjs(a),e=c.data("zmoduleuipopupoption");if(e&&!c.hasClass("zui-popup-hide")){var f=function(){c.addClass("zui-popup-hide");c.removeClass("active").trigger("ui.popup.hide");!d&&e.closethenremove&&c.remove()};a=function(){c&&c.data("zmoduleuipopupcoverel").remove(!1)};
(b=b||!1)||!e.fade||e.animate?!b&&e.animate?(window.clearTimeout(g),window.clearTimeout(h),c.addClass("hiding animate animate-start"),g=function(){c.addClass("animate-end")}.delay(e.animateTime),h=function(){c.removeClass("hiding animate animate-start animate-end");f()}.delay(e.animateTime+100)):f():c.fadeOut({time:e.fadeTime,callback:f});!b&&e.fadeCover?c.data("zmoduleuipopupcoverel").fadeOut({time:e.fadeTime,callback:a}):a();c.removeAttr("data-show-instance")}},p=function(a){var b=zjs(a);b.data("zmoduleuipopupoption")&&
!b.hasClass("zui-popup-hide")&&(b.hasClass("zui-popup-center")&&l(a),b.trigger("ui.popup.refresh"))},l=function(a){a=zjs(a);var b=a.data("zmoduleuipopupoption");if(b&&a.hasClass("zui-popup-center")){var d=zjs(window).height()-a.height();if(0<d){var c=-a.height()/2;b.centerY||(c-=d/6)}else b=a.getData("zmoduleuipopupscrolltop")-document.body.scrollTop,b<d&&(b=d),0<b&&(b=0),c=-a.height()/2-d/2+b;a.style("margin-top",c);a.style("margin-left",-a.width()/2)}};zjs(document).on("keyup",function(a){if(27==
a.keyCode()){for(var b=!1;0<window.zpopupelementstack.length&&!(b=window.zpopupelementstack.pop(),b=zjs('.zui-popup[data-show-instance="'+b+'"]'),0<b.count());)b=!1;b&&(a.preventDefault(),b.popupHide())}});zjs.extendMethod({makePopup:function(a){return this.each(function(b){q(b,a)})},popupShow:function(){return this.each(function(a){n(a)})},popupHide:function(){return this.each(function(a){k(a)})},popupRefresh:function(){return this.each(function(a){p(a)})}});zjs.hook({after_setInnerHTML:function(a){zjs(a).find(".zpopup").makePopup();
zjs(a).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()},after_insertDOM:function(a){zjs(a).hasClass("zpopup")&&zjs(a).makePopup();zjs(a).find(".zpopup").makePopup();zjs(a).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()}});zjs.onready(function(){zjs(".zpopup").makePopup()});"required"in zjs&&zjs.required("ui.popup")});